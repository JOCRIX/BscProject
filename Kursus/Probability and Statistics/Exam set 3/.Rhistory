url <- "https://asta.math.aau.dk/static-files/asta/img/battery.png"
z <- tempfile()
download.file(url, z, mode = "wb")
grid::grid.raster(png::readPNG(z))
invisible(file.remove(z))
library(mosaic)
library(gridExtra)
capacity<-read.delim("https://asta.math.aau.dk/datasets?file=capacity.txt",sep="")
capacity$Temperature<-factor(capacity$Temperature)
capacity
gf_point(logQ~ logFEC, color = ~Temperature, group = ~Temperature, data = capacity)
tempGrupper=split(capacity,capacity$Temperature)
lapply(tempGrupper,function(x) cor(x$logQ,x$logFEC))
model<-lm(logQ~logFEC+Temperature,data=capacity)
summary(model)
mod1<-plotModel(model)
mod1
pdist("f", 1031, df1=3, df2=(61-3-1))
model2<-lm(logQ~logFEC*Temperature,data=capacity)
summary(model)
anova(model, model2)
mod2 <- plotModel(model2)
grid.arrange(mod1, mod2, ncol = 1)
residuals<-model$residuals
boxplot(residuals, col = "lightblue")
